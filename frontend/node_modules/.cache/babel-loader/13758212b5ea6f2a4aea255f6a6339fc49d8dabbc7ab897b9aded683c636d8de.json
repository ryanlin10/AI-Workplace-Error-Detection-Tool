{"ast":null,"code":"var _jsxFileName = \"/Users/suleimanmahmood/Documents/software engineering stuff/BuildX2/frontend/src/components/VideoCapture.js\",\n  _s = $RefreshSig$();\nimport React, { useRef, useEffect, useState, useCallback } from 'react';\nimport './VideoCapture.css';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst VideoCapture = ({\n  isActive,\n  onImageCapture\n}) => {\n  _s();\n  const videoRef = useRef(null);\n  const streamRef = useRef(null);\n  const [isCameraReady, setIsCameraReady] = useState(false);\n  const [cameraError, setCameraError] = useState(false);\n\n  // Function to capture image from video\n  const captureImage = useCallback(() => {\n    if (videoRef.current && videoRef.current.videoWidth > 0) {\n      console.log('Capturing image from video');\n      try {\n        const canvas = document.createElement('canvas');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        const imageDataUrl = canvas.toDataURL('image/jpeg');\n        console.log('Image captured successfully, data URL length:', imageDataUrl.length);\n        onImageCapture(imageDataUrl);\n        return true;\n      } catch (error) {\n        console.error('Error capturing image:', error);\n        return false;\n      }\n    } else {\n      console.warn('Video element not ready for capture');\n      return false;\n    }\n  }, [onImageCapture]);\n\n  // Periodic image capture during recording\n  useEffect(() => {\n    let captureInterval;\n    if (isActive && isCameraReady) {\n      // Capture an initial image after camera is ready\n      setTimeout(() => {\n        captureImage();\n      }, 1000);\n\n      // Set up interval to capture image every 5 seconds during recording\n      captureInterval = setInterval(() => {\n        captureImage();\n      }, 5000);\n    }\n    return () => {\n      if (captureInterval) {\n        clearInterval(captureInterval);\n      }\n    };\n  }, [isActive, isCameraReady, captureImage]);\n\n  // Handle camera setup and teardown\n  useEffect(() => {\n    if (isActive && !isCameraReady && !cameraError) {\n      console.log('Starting camera');\n      // Start camera\n      navigator.mediaDevices.getUserMedia({\n        video: {\n          width: {\n            ideal: 1280\n          },\n          height: {\n            ideal: 720\n          }\n        }\n      }).then(stream => {\n        console.log('Camera access granted');\n        streamRef.current = stream;\n        if (videoRef.current) {\n          videoRef.current.srcObject = stream;\n          videoRef.current.onloadedmetadata = () => {\n            videoRef.current.play().then(() => {\n              console.log('Video playback started');\n              setIsCameraReady(true);\n            }).catch(error => {\n              console.error('Error starting video playback:', error);\n              setCameraError(true);\n            });\n          };\n        }\n      }).catch(error => {\n        console.error('Error accessing camera:', error);\n        setCameraError(true);\n      });\n    } else if (!isActive) {\n      // Stop camera and capture final image if we were active\n      if (streamRef.current && isCameraReady) {\n        console.log('Stopping camera and capturing final image');\n        const captured = captureImage();\n\n        // Ensure we have at least one image\n        if (!captured) {\n          console.log('Final capture failed, trying one more time');\n          setTimeout(() => {\n            captureImage();\n          }, 500);\n        }\n\n        // Stop all tracks\n        streamRef.current.getTracks().forEach(track => {\n          track.stop();\n          console.log(`Track ${track.kind} stopped`);\n        });\n        streamRef.current = null;\n        setIsCameraReady(false);\n      }\n    }\n    return () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [isActive, isCameraReady, captureImage, cameraError]);\n\n  // Manual capture button handler\n  const handleManualCapture = () => {\n    if (isCameraReady) {\n      captureImage();\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"video-capture\",\n    children: [/*#__PURE__*/_jsxDEV(\"video\", {\n      ref: videoRef,\n      className: isActive ? 'active' : 'inactive',\n      muted: true,\n      playsInline: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), isActive && isCameraReady && /*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"capture-button\",\n      onClick: handleManualCapture,\n      title: \"Take a snapshot\",\n      children: \"\\uD83D\\uDCF7\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 9\n    }, this), !isActive && !isCameraReady && !cameraError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"camera-inactive\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Click \\\"Start Stream\\\" to activate camera\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 9\n    }, this), cameraError && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"camera-error\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Camera access error. Please check your permissions.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 156,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 130,\n    columnNumber: 5\n  }, this);\n};\n_s(VideoCapture, \"uadJHbIzVGFNr68hQIbj0EnLy1s=\");\n_c = VideoCapture;\nexport default VideoCapture;\nvar _c;\n$RefreshReg$(_c, \"VideoCapture\");","map":{"version":3,"names":["React","useRef","useEffect","useState","useCallback","jsxDEV","_jsxDEV","VideoCapture","isActive","onImageCapture","_s","videoRef","streamRef","isCameraReady","setIsCameraReady","cameraError","setCameraError","captureImage","current","videoWidth","console","log","canvas","document","createElement","width","height","videoHeight","ctx","getContext","drawImage","imageDataUrl","toDataURL","length","error","warn","captureInterval","setTimeout","setInterval","clearInterval","navigator","mediaDevices","getUserMedia","video","ideal","then","stream","srcObject","onloadedmetadata","play","catch","captured","getTracks","forEach","track","stop","kind","handleManualCapture","className","children","ref","muted","playsInline","fileName","_jsxFileName","lineNumber","columnNumber","onClick","title","_c","$RefreshReg$"],"sources":["/Users/suleimanmahmood/Documents/software engineering stuff/BuildX2/frontend/src/components/VideoCapture.js"],"sourcesContent":["import React, { useRef, useEffect, useState, useCallback } from 'react';\nimport './VideoCapture.css';\n\nconst VideoCapture = ({ isActive, onImageCapture }) => {\n  const videoRef = useRef(null);\n  const streamRef = useRef(null);\n  const [isCameraReady, setIsCameraReady] = useState(false);\n  const [cameraError, setCameraError] = useState(false);\n  \n  // Function to capture image from video\n  const captureImage = useCallback(() => {\n    if (videoRef.current && videoRef.current.videoWidth > 0) {\n      console.log('Capturing image from video');\n      try {\n        const canvas = document.createElement('canvas');\n        canvas.width = videoRef.current.videoWidth;\n        canvas.height = videoRef.current.videoHeight;\n        const ctx = canvas.getContext('2d');\n        ctx.drawImage(videoRef.current, 0, 0, canvas.width, canvas.height);\n        \n        const imageDataUrl = canvas.toDataURL('image/jpeg');\n        console.log('Image captured successfully, data URL length:', imageDataUrl.length);\n        onImageCapture(imageDataUrl);\n        return true;\n      } catch (error) {\n        console.error('Error capturing image:', error);\n        return false;\n      }\n    } else {\n      console.warn('Video element not ready for capture');\n      return false;\n    }\n  }, [onImageCapture]);\n  \n  // Periodic image capture during recording\n  useEffect(() => {\n    let captureInterval;\n    \n    if (isActive && isCameraReady) {\n      // Capture an initial image after camera is ready\n      setTimeout(() => {\n        captureImage();\n      }, 1000);\n      \n      // Set up interval to capture image every 5 seconds during recording\n      captureInterval = setInterval(() => {\n        captureImage();\n      }, 5000);\n    }\n    \n    return () => {\n      if (captureInterval) {\n        clearInterval(captureInterval);\n      }\n    };\n  }, [isActive, isCameraReady, captureImage]);\n  \n  // Handle camera setup and teardown\n  useEffect(() => {\n    if (isActive && !isCameraReady && !cameraError) {\n      console.log('Starting camera');\n      // Start camera\n      navigator.mediaDevices.getUserMedia({ \n        video: { \n          width: { ideal: 1280 },\n          height: { ideal: 720 }\n        } \n      })\n        .then(stream => {\n          console.log('Camera access granted');\n          streamRef.current = stream;\n          if (videoRef.current) {\n            videoRef.current.srcObject = stream;\n            videoRef.current.onloadedmetadata = () => {\n              videoRef.current.play()\n                .then(() => {\n                  console.log('Video playback started');\n                  setIsCameraReady(true);\n                })\n                .catch(error => {\n                  console.error('Error starting video playback:', error);\n                  setCameraError(true);\n                });\n            };\n          }\n        })\n        .catch(error => {\n          console.error('Error accessing camera:', error);\n          setCameraError(true);\n        });\n    } else if (!isActive) {\n      // Stop camera and capture final image if we were active\n      if (streamRef.current && isCameraReady) {\n        console.log('Stopping camera and capturing final image');\n        const captured = captureImage();\n        \n        // Ensure we have at least one image\n        if (!captured) {\n          console.log('Final capture failed, trying one more time');\n          setTimeout(() => {\n            captureImage();\n          }, 500);\n        }\n        \n        // Stop all tracks\n        streamRef.current.getTracks().forEach(track => {\n          track.stop();\n          console.log(`Track ${track.kind} stopped`);\n        });\n        streamRef.current = null;\n        setIsCameraReady(false);\n      }\n    }\n    \n    return () => {\n      if (streamRef.current) {\n        streamRef.current.getTracks().forEach(track => track.stop());\n      }\n    };\n  }, [isActive, isCameraReady, captureImage, cameraError]);\n  \n  // Manual capture button handler\n  const handleManualCapture = () => {\n    if (isCameraReady) {\n      captureImage();\n    }\n  };\n  \n  return (\n    <div className=\"video-capture\">\n      <video \n        ref={videoRef} \n        className={isActive ? 'active' : 'inactive'} \n        muted\n        playsInline\n      />\n      \n      {isActive && isCameraReady && (\n        <button \n          className=\"capture-button\" \n          onClick={handleManualCapture}\n          title=\"Take a snapshot\"\n        >\n          ðŸ“·\n        </button>\n      )}\n      \n      {!isActive && !isCameraReady && !cameraError && (\n        <div className=\"camera-inactive\">\n          <p>Click \"Start Stream\" to activate camera</p>\n        </div>\n      )}\n      \n      {cameraError && (\n        <div className=\"camera-error\">\n          <p>Camera access error. Please check your permissions.</p>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default VideoCapture; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}